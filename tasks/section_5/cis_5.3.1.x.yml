---

- name: "5.3.1.1 | PATCH | Ensure latest version of pam is installed"
  when: rhel10cis_rule_5_3_1_1
  tags:
    - level1-server
    - level1-workstation
    - patch
    - pam
    - rule_5.3.1.1
  ansible.builtin.package:
    name: pam
    state: latest

- name: "5.3.1.2 | PATCH | Ensure latest version of authselect is installed"
  when: rhel10cis_rule_5_3_1_2
  tags:
    - level1-server
    - level1-workstation
    - patch
    - pam
    - rule_5.3.1.2
  block:
    - name: "5.3.1.2 | PATCH | Ensure latest version of authselect is installed | Patch"
      ansible.builtin.package:
        name: authselect
        state: latest
      register: discovered_authselect_updated

    - name: "5.3.1.2 | AUDIT | Ensure latest version of authselect is installed | Patch"
      when: discovered_authselect_updated.changed # noqa no-handler
      ansible.builtin.set_fact:
        authselect_update: OK

- name: "5.3.1.3 | PATCH | Ensure libpwquality is installed"
  when: rhel10cis_rule_5_3_1_3
  tags:
    - level1-server
    - level1-workstation
    - patch
    - pam
    - rule_5.3.1.3
  ansible.builtin.package:
    name: libpwquality
